---
layout:     post
title:      机器学习在药物研发领域的一些应用
subtitle:   临床前的应用以及未来机器化的研发模式
date:       2023-10-10
author:     SHGuan
header-img: img/post-bg-re-vs-ng2.jpg
catalog: true
tags:
    - Review
---

> 机器学习目前正被药物研发领域所看重，一方面源自传统药物研发模式的成本高、风险高、耗时长等特点，另一方面源自近年来自然语言处理技术等的快速发展、药物研发领域的数据的不断累积、算力的不断增长等。
> 尽管目前还未有一款机器学习全程参与研发的药物上市，但机器学习技术确实已经在药物研发的许多步骤中都得到了应用。  
> 因此，本文将就这些应用展开说明，回顾机器学习技术对药物研发的助力以及目前遇到的一些问题或瓶颈。  
> 
> 
  
#   药物研发的过程  

## 疾病基因预测  
一般来说，确认某种疾病的靶点，是药物开发的第一步。无论是小分子药物还是RNA药物或者多肽、抗体药物，其作用大多是通过对受体、酶等蛋白质或者指导蛋白质转录的mRNA的调控来实现的。而一个对于可以延缓、组织甚至逆转疾病的发展且具有一定安全性的靶点，不仅可以减少后期研发阶段的成本，也可以减少后期研发阶段的失败率。当有了一个明确的有效的靶点之后，传统的基于结构的药物设计（Structure Based Drug Design，SBDD）技术才有了切入点。当下，靶点确认的策略可以粗略地分为三类：基于实验的策略、基于组学的策略、基于计算的策略。这三种策略的组合互补和互相验证越来越成为了趋势，这使得我们可以从不同的视角去确认靶点在细胞中的作用。而在基于计算的策略中，机器学习的方法大概包括三种：传统的机器学习模型构建的分类模型、深度学习构建的分类模型、杂糅了传统机器学习和/或深度学习的集成学习的分类模型。  
  
通常来说，对于某种疾病，部分相关基因是已知的，而大部分基因是否与该疾病有较大的相关性是不确定的。已知的相关基因即为阳性基因（Positive Genes），大量的未知基因即为未标签基因（Unlabeled Genes）。出于这种数据分布的特点，越来越多的模型采用了PU学习（Positive and Unlabeled Learning, PU Learning）方法来进行训练。最近提出的[SPEOS](https://github.com/fratajcz/speos)模型则采用了集成学习+PU学习的方法，以利用罕见的孟德尔遗传病基因作为训练过程中的“真正阳性”核心基因，从而发现尚未发现的核心基因。其采用的理论假设基础是Boyle等人2017年提出的[泛基因模型](https://pubmed.ncbi.nlm.nih.gov/28622505/)，即核心基因通过其蛋白质的表达或者活性的变化直接影响疾病表型，而其他基因，即外围基因，通过影响核心基因的表达或者活性等间接影响表型。  
  
## 虚拟筛选
机器学习助力更快速地对化合物进行筛选。虚拟筛选（Virtual Screening）使用计算机工具从海量的分子中筛选出和靶标亲和力较高的一些分子。CADD技术中的虚拟筛选包括基于受体的虚拟筛选和基于配体的虚拟筛选，前者包括基于分子对接的筛选，后者包括基于药效团的筛选、基于定量构效关系模型（QSAR）的筛选和基于分子相似性的筛选。分子对接技术在预测蛋白质和小分子药物如何结合时起到了关键作用。 
  
基于机器学习的分子对接大幅减少所需时间。  
  
机器学习技术帮助快速地对靶标结构未知的化合物进行亲和性筛选。一些蛋白由于原因，仍然没有完整的解析的结构。对于结构未知或者结构不完整的靶标而言，分子对接技术是无法使用的，此时其他基于机器学习的方法发挥了独特的作用。  transformerCPI2.0等模型不依赖于靶标的结构信息，仅依靠蛋白氨基酸序列和药物简化分子线性输入规范(Simplified Molecular-Input Line-Entry System, SMILES)信息即可快速进行筛选。
  
机器学习技术助力根据表型进行分子筛选。尽管基于靶标的药物筛选是当下的主流并取得了一系列显著的成果，但一些基于表型的药物虚拟筛选方法近期也进入人们视野中。这类方法由于不需要预先设置明确的靶标，因而省去了靶标发现和靶标验证这两个步骤，一方面可以节省消耗的时间、物力和人力，另一方面则可以避免对仅数百个可用的靶点中的激烈的竞争。面临着如何有效地量化分子对疗效这一挑战。这种基于表型的研发模式对于机制未明确、缺乏明确靶标的疾病（如一些罕见病）和一些定义比较广泛的表型（如衰老状态本身并不是一种明确的疾病）的药物研发是极为重要的。灵素系统（Deep Learning Efficacy Prediction System, DLEPS）以病理状态下的基因指纹（高表达和低表达的特征基因集）作为表型来筛选出可以逆转转录谱的分子。基于L1000项目的数据，该模型可以预测出输入的分子的疗效（分子处理后的转录谱），即平均的转录谱加上分子对于该转录谱的影响。而后通过基于基因富集的打分函数用于筛选出可以逆转输入的基因指纹的分子。
  
## 药物属性预测  
  
## 药物协同效应预测
癌细胞容易对单一靶点的药物产生耐药性，而药物组合可以在一定程度上缓解耐药性问题，而且可以通过针对不同的靶点来实现1+1大于2的协同效应。药物协同效应用于量化药物对潜力。较高的药物协同效应分数，往往对应着药物组合的疗效较好、不良反应较低。
  
然而，目前大多数的预测模型只关注了少数的数据丰富的细胞系，而不支持预测多数的数据贫乏的细胞系，这使得这些模型只能预测少部分癌症对应的少部分细胞系中的药物协同效应，极大地限制了这些模型的使用。张绍武教授等人提出的一种少样本学习方法（HyperSynergy）则尝试解决这个问题，HyperSynergy模型包括特征嵌入网络模块（Feature Embedding Module）、元生成网络模块（Meta-Generative Network）和协同预测网络模块（Synergy Prediction Module）。特征嵌入网络从细胞系转录组数据和药物对（drug-pair）的分子图中提取细胞系和药物对的高级特征/低维度特征；元生成网络基于每个细胞系的任务嵌入向量生成特定细胞系协同预测网络的权重和偏置参数。之后基于在特征嵌入网络学习到的低维度特征和元生成网络生成的权重等参数，协同预测网络计算药物协同得分。对比实验结果表明，HyperSynergy不仅在具有少量样本的数据贫乏细胞系上优于其他最先进的方法，而且在数据丰富的细胞系上也优于其他最先进的方法。

## 大模型加持下一种可能的药物研发模式
大语言模型（Large Language Models, LLMs）有着出色的理解能力，这种理解能力不仅包括对于人类语言的理解，也包括对于编程语言的理解。这使得其不仅可以总结文本资料、从文本中抽取数据，也可以通过api等调用各种计算工具。换言之，LLMs具有充当人机交互的中介的潜力。
借助于如[TOOLLLM]()之类的LLMs工具学习框架，LLMs可以学习到借助api来调用多种工具的能力，这大大拓展了LLMs的能力边界。
此外，类似于的LLMs已经实现了对多模态数据的处理能力和真实世界工具的调用能力。
在将来，借助于LLMs的多面能力，有望实现从文献中总结生物和化学知识，通过调用已经存在的模型或者软件来进行各种计算任务进而完成对靶点、分子的筛选，通过化学机器人和类器官模型等技术进行临床前实验验证并最终总结结果的整个过程。
